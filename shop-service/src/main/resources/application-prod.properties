# ============================================================================
# Test Profile Configuration (H2 In-Memory Database)
# ============================================================================

# H2 In-Memory Database for Testing
spring.datasource.url=jdbc:h2:mem:testdb;MODE=MySQL;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

# JPA Configuration for Testing
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true

# H2 Console (for debugging tests)
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# Disable email in tests
shop.email.enabled=false
spring.mail.host=localhost
spring.mail.port=2525

# Test JWT configuration
jwt.secret=test-secret-key-for-testing-only-not-for-production
jwt.expiration=3600000

# Mock payment providers
paypal.mode=sandbox
paypal.client.id=test-id
paypal.client.secret=test-secret

stripe.api.key=${STRIPE_API_KEY:sk_test_placeholder}
#stripe.webhook.secret=test-webhook-secret


# Test Logging
logging.level.root=WARN
logging.level.com.perfect8.shop=DEBUG
logging.level.org.springframework.test=DEBUG

# Disable security for easier testing (if needed)
# spring.security.enabled=false

# Test microservice URLs (use WireMock or similar)
admin.service.url=http://localhost:9999
image.service.url=http://localhost:9998
blog.service.url=http://localhost:9997

# Disable cache in tests
spring.cache.type=none

# Allow all CORS in tests
cors.allowed-origins=*

# Async configuration (run synchronously in tests)
spring.task.execution.pool.core-size=1
spring.task.execution.pool.max-size=1

# Actuator
management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always

# File upload
spring.servlet.multipart.max-file-size=1MB
spring.servlet.multipart.max-request-size=2MB

# Error handling for tests
server.error.include-message=always
server.error.include-stacktrace=always
server.error.include-exception=true

# Jackson
spring.jackson.serialization.indent-output=true
spring.jackson.default-property-inclusion=non_null

# Session
server.servlet.session.timeout=1m

# Test data
test.data.enabled=true
test.data.customer.count=5
test.data.product.count=20
test.data.order.count=10