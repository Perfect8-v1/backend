# Email Service Configuration
# Server Configuration
server.port=8085
server.servlet.context-path=/
spring.application.name=email-service

# Database Configuration - MariaDB
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.url=jdbc:mysql://database:3306/perfect8_email?createDatabaseIfNotExist=true&allowPublicKeyRetrieval=true&useSSL=false&serverTimezone=UTC
spring.datasource.username=perfect8user
spring.datasource.password=java100_datasource_password

# JPA Configuration
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.open-in-view=false

# Connection Pool
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.connection-timeout=20000

# Profile
spring.profiles.active=${SPRING_PROFILES_ACTIVE:development}

# SMTP Configuration - För autentisering/login
spring.mail.host=${SMTP_HOST:smtp.gmail.com}
spring.mail.port=${SMTP_PORT:587}
spring.mail.username=${SMTP_USERNAME:taxiberglund@gmail.com}
spring.mail.password=${SMTP_PASSWORD:perfect8java100}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000

# Email Sender Configuration - För avsändarinformation
mail.from.address=${MAIL_FROM_ADDRESS:noreply@perfect8.com}
mail.from.name=${MAIL_FROM_NAME:Perfect8 Shop}
mail.reply-to=${MAIL_REPLY_TO:support@perfect8.com}
mail.support.address=${MAIL_SUPPORT:support@perfect8.com}

# Email Settings
mail.enabled=${MAIL_ENABLED:true}
mail.async.enabled=true
mail.retry.max-attempts=3
mail.retry.delay=1000

# Integration med andra services
shop.service.url=${SHOP_SERVICE_URL:http://shop-service:8081}
image.service.url=${IMAGE_SERVICE_URL:http://image-service:8084}
admin.service.url=${ADMIN_SERVICE_URL:http://admin-service:8083}
blog.service.url=${BLOG_SERVICE_URL:http://blog-service:8082}

# Email Queue Configuration
mail.queue.enabled=true
mail.queue.batch-size=10
mail.queue.process-interval=5000

# Email Categories (för olika typer av emails)
mail.category.order.enabled=true
mail.category.order.from=${MAIL_ORDER_FROM:orders@perfect8.com}
mail.category.marketing.enabled=true
mail.category.marketing.from=${MAIL_MARKETING_FROM:news@perfect8.com}
mail.category.system.enabled=true
mail.category.system.from=${MAIL_SYSTEM_FROM:system@perfect8.com}

# HTML Template Configuration (Enkel HTML utan Thymeleaf)
mail.templates.path=classpath:templates/
mail.templates.cache=false
mail.templates.encoding=UTF-8
mail.templates.use-inline-css=true
mail.templates.default-template=default.html

# HTML Content Settings
mail.content.type=text/html
mail.content.charset=UTF-8
mail.content.inline-images=true
mail.content.minify=false

# Async Configuration
spring.task.execution.pool.core-size=5
spring.task.execution.pool.max-size=10
spring.task.execution.pool.queue-capacity=25
spring.task.execution.thread-name-prefix=email-async-

# Logging
logging.level.com.perfect8.email=DEBUG
logging.level.org.springframework.mail=DEBUG
logging.level.org.hibernate.SQL=WARN
logging.level.com.sun.mail=DEBUG

# Actuator
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always

# Jackson
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.serialization.indent-output=true

# Development/Test Settings (kommentera ut i produktion)
mail.test.mode=${MAIL_TEST_MODE:false}
mail.test.recipient=${MAIL_TEST_RECIPIENT:test@perfect8.com}

# Rate Limiting (för att undvika spam)
mail.rate-limit.enabled=true
mail.rate-limit.per-minute=60
mail.rate-limit.per-hour=500

# Bounce Handling
mail.bounce.address=${MAIL_BOUNCE_ADDRESS:bounce@perfect8.com}
mail.bounce.auto-process=true

# Feign Client Configuration (om du använder Feign)
feign.client.config.default.connectTimeout=5000
feign.client.config.default.readTimeout=5000

# CORS (om email-service har REST endpoints)
cors.allowed-origins=http://localhost:3000,http://localhost:8080
cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
cors.allowed-headers=*
cors.allow-credentials=true

